<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <!-- PWA Settings -->
    <link rel="manifest" href="/static/manifest.json">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="NutTracker">
    <meta name="theme-color" content="#ffffff">

    <title>NutTracker</title>

    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/static/sw.js')
                    .then(reg => console.log('Service Worker: Registered'))
                    .catch(err => console.log(`Service Worker: Error: ${err}`));
            });
        }
    </script>

    <link rel="stylesheet" href="../static/css/style.css">
</head>
<body>

<div class="appContainer">
    <header class="appHeader">
        <h2>NutTracker</h2>
        <button id="menuBtn" class="iconBtn" style="color: #333;">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M3 12H21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M3 6H21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M3 18H21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
        </button>
    </header>

    <main class="contentArea">
        <div id="todayMain" class="card summaryCard">
            <h3>Calories Left</h3>
            <div class="progressCircle">
                <h1>1,250</h1>
                <p>of 2,500 kcal</p>
            </div>
        </div>

        <div class="sectionHeader">
            <h3>Today's Meals</h3>
            <button id="viewAllMealsBtn" class="viewAll" style="background:none; border:none; cursor:pointer;">View All</button>
        </div>

        <ul class="mealList">
            <li class="mealItem">
                <div class="mealInfo">
                    <span class="mealName">Oatmeal & Berries</span>
                    <span class="mealTime">08:30 AM</span>
                </div>
                <span class="mealCals">350 kcal</span>
            </li>
            <li class="mealItem">
                <div class="mealInfo">
                    <span class="mealName">Grilled Chicken Salad</span>
                    <span class="mealTime">12:15 PM</span>
                </div>
                <span class="mealCals">450 kcal</span>
            </li>
            <li class="mealItem">
                <div class="mealInfo">
                    <span class="mealName">Apple</span>
                    <span class="mealTime">03:00 PM</span>
                </div>
                <span class="mealCals">95 kcal</span>
            </li>
             <!-- Duplicate items to demonstrate scrolling -->
            <li class="mealItem">
                <div class="mealInfo">
                    <span class="mealName">Protein Shake</span>
                    <span class="mealTime">05:45 PM</span>
                </div>
                <span class="mealCals">180 kcal</span>
            </li>
        </ul>
    </main>

    <nav id="bottomNav">
        <button id="navWorkout" class="navItem">
            <svg class="navIcon" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M6.5 17H3.5C2.67157 17 2 16.3284 2 15.5V8.5C2 7.67157 2.67157 7 3.5 7H6.5M17.5 17H20.5C21.3284 17 22 16.3284 22 15.5V8.5C22 7.67157 21.3284 7 20.5 7H17.5M6.5 17V7M17.5 17V7M6.5 12H17.5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <span class="label">Workout</span>
        </button>
        <div class="navSpacer"></div> <!-- Spacer for the floating button -->
        <button id="navAdd" class="navItem addBtn">
            <svg class="icon" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M12 4V20M4 12H20" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
        </button>
        <button id="navStats" class="navItem">
            <svg class="navIcon" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M18 20V10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M12 20V4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M6 20V14" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <span class="label">Stats</span>
        </button>
    </nav>
</div>

<!-- Modal Container for Full Meal List -->
<div id="todaysMealsContainer" class="modalOverlay hiddenView">
    <div class="statsView">
        <header id="todaysMealsHeader" class="statsHeader">
            <h3>Today's Meals</h3>
            <button id="closeTodaysMeals" class="iconBtn">&times;</button>
        </header>
        <div class="statsContent">
            <ul class="mealList" id="todaysMealList">
                <!-- Oatmeal -->
                <li>
                    <div class="mealItem expandable" data-details="details-1">
                        <div class="mealInfo">
                            <span class="mealName">Oatmeal & Berries</span>
                        </div>
                        <span class="mealCals">150g</span>
                    </div>
                    <div id="details-1" class="mealDetails hiddenView">
                        <div class="detailGrid">
                            <div class="detailItem"><span class="dLabel">Calories</span><span class="dVal">350</span></div>
                            <div class="detailItem"><span class="dLabel">Protein</span><span class="dVal">12g</span></div>
                            <div class="detailItem"><span class="dLabel">Carbs</span><span class="dVal">45g</span></div>
                            <div class="detailItem"><span class="dLabel">Fat</span><span class="dVal">6g</span></div>
                            <div class="detailItem"><span class="dLabel">Fiber</span><span class="dVal">8g</span></div>
                        </div>
                    </div>
                </li>

                <!-- Chicken Salad -->
                <li>
                    <div class="mealItem expandable" data-details="details-2">
                        <div class="mealInfo">
                            <span class="mealName">Grilled Chicken Salad</span>
                        </div>
                        <span class="mealCals">300g</span>
                    </div>
                    <div id="details-2" class="mealDetails hiddenView">
                        <div class="detailGrid">
                            <div class="detailItem"><span class="dLabel">Calories</span><span class="dVal">450</span></div>
                            <div class="detailItem"><span class="dLabel">Protein</span><span class="dVal">40g</span></div>
                            <div class="detailItem"><span class="dLabel">Carbs</span><span class="dVal">12g</span></div>
                            <div class="detailItem"><span class="dLabel">Fat</span><span class="dVal">20g</span></div>
                            <div class="detailItem"><span class="dLabel">Fiber</span><span class="dVal">5g</span></div>
                        </div>
                    </div>
                </li>

                 <!-- Apple -->
                <li>
                    <div class="mealItem expandable" data-details="details-3">
                        <div class="mealInfo">
                            <span class="mealName">Apple</span>
                        </div>
                        <span class="mealCals">120g</span>
                    </div>
                    <div id="details-3" class="mealDetails hiddenView">
                        <div class="detailGrid">
                            <div class="detailItem"><span class="dLabel">Calories</span><span class="dVal">95</span></div>
                            <div class="detailItem"><span class="dLabel">Protein</span><span class="dVal">0.5g</span></div>
                            <div class="detailItem"><span class="dLabel">Carbs</span><span class="dVal">25g</span></div>
                            <div class="detailItem"><span class="dLabel">Fat</span><span class="dVal">0.3g</span></div>
                            <div class="detailItem"><span class="dLabel">Fiber</span><span class="dVal">4g</span></div>
                        </div>
                    </div>
                </li>
            </ul>
        </div>
    </div>
</div>

<div id="workoutContainer" class="modalOverlay hiddenView">
    <div class="statsView"> <!-- Reusing stats view container for full screen -->
        <header class="statsHeader">
            <h3>Workouts</h3>
            <button id="closeWorkout" class="iconBtn">&times;</button>
        </header>
        
        <div class="statsContent">
            <!-- Add Exercise Section -->
            <div id="logExerciseContainer" class="chartSection" style="padding-bottom: 10px; margin-top: 20px;">
                <h4>Log Exercise</h4>
                <form id="workoutForm">
                    <div class="formGroup">
                        <input type="text" id="exerciseName" class="formControl" placeholder="Exercise Name (e.g. Bench Press)">
                    </div>
                    <div class="miniNutrientGrid" style="gap: 10px; margin-bottom: 15px;">
                        <div class="formGroup" style="margin:0; flex:1;">
                            <input type="number" id="sets" class="formControl" placeholder="Sets" style="text-align:center;">
                        </div>
                        <div class="formGroup" style="margin:0; flex:1;">
                            <input type="number" id="reps" class="formControl" placeholder="Reps" style="text-align:center;">
                        </div>
                        <div class="formGroup" style="margin:0; flex:1;">
                            <input type="number" id="weight" class="formControl" placeholder="kg" style="text-align:center;">
                        </div>
                    </div>
                    <button type="submit" class="submitBtn" style="padding: 10px;">Add Set</button>
                </form>
            </div>

            <!-- Today's Workout List -->
            <div class="sectionHeader">
                <h3>Today's Log</h3>
            </div>
            <ul id="workoutList" class="mealList">
                <!-- Placeholder Data -->
                <li class="mealItem">
                    <div class="mealInfo">
                        <span class="mealName">Squats</span>
                        <span class="mealTime">3 sets</span>
                    </div>
                    <span class="mealCals">100kg x 5</span>
                </li>
                <li class="mealItem">
                    <div class="mealInfo">
                        <span class="mealName">Bench Press</span>
                        <span class="mealTime">4 sets</span>
                    </div>
                    <span class="mealCals">80kg x 8</span>
                </li>
            </ul>
        </div>
    </div>
</div>

<div id="modalNutrients" class="modalOverlay hiddenView">
    <div class="nutrientModal">
        <h3>Today's Nutrients</h3>
        <div class="nutrientGrid">
            <div class="nutrientItem">
                <span class="nutrientLabel">Calories</span>
                <span class="nutrientValue" id="valCalories">0</span>
                <span class="nutrientUnit">kcal / 2500</span>
                <div class="miniTrack"><div class="miniFill" id="fillCalories"></div></div>
            </div>
            <div class="nutrientItem">
                <span class="nutrientLabel">Protein</span>
                <span class="nutrientValue" id="valProtein">0</span>
                <span class="nutrientUnit">g / 180</span>
                <div class="miniTrack"><div class="miniFill" id="fillProtein"></div></div>
            </div>
            <div class="nutrientItem">
                <span class="nutrientLabel">Carbs</span>
                <span class="nutrientValue" id="valCarbs">0</span>
                <span class="nutrientUnit">g / 300</span>
                <div class="miniTrack"><div class="miniFill" id="fillCarbs"></div></div>
            </div>
            <div class="nutrientItem">
                <span class="nutrientLabel">Fat</span>
                <span class="nutrientValue" id="valFat">0</span>
                <span class="nutrientUnit">g / 80</span>
                <div class="miniTrack"><div class="miniFill" id="fillFat"></div></div>
            </div>
            <div class="nutrientItem">
                <span class="nutrientLabel">Fiber</span>
                <span class="nutrientValue" id="valFiber">0</span>
                <span class="nutrientUnit">g / 35</span>
                <div class="miniTrack"><div class="miniFill" id="fillFiber"></div></div>
            </div>
        </div>
        <button id="closeNutrients" class="closeBtn">Close</button>
    </div>
</div>

<div id="addMeal" class="modalOverlay hiddenView">
    <div class="nutrientModal"> <!-- Reusing container style -->
        <h3>Add Meal</h3>
        
        <form id="addMealForm" class="mealForm">
            <div class="formGroup">
                <label for="foodSearch">Select Food</label>
                <div class="searchWrapper">
                    <input type="text" id="foodSearch" class="formControl" placeholder="Search food..." autocomplete="off">
                    <button type="button" id="clearSearch" class="clearSearchBtn hiddenView">&times;</button>
                </div>
                <div id="foodList" class="foodListContainer"></div>
                <input type="hidden" id="selectedFood">
            </div>

            <div class="nutritionLogSection">
                <h4>Nutrition per 100g</h4>
                <div class="miniNutrientGrid">
                    <div class="miniItem"><span class="lbl">Cal</span><span class="val" id="infoCal">-</span></div>
                    <div class="miniItem"><span class="lbl">Pro</span><span class="val" id="infoPro">-</span></div>
                    <div class="miniItem"><span class="lbl">Carb</span><span class="val" id="infoCarb">-</span></div>
                    <div class="miniItem"><span class="lbl">Fat</span><span class="val" id="infoFat">-</span></div>
                </div>
            </div>

            <div class="formGroup">
                <label for="foodQuantity">Quantity (grams)</label>
                <div class="qtyStepper">
                    <button type="button" id="qtyDec" class="stepperBtn minus">&minus;</button>
                    <input type="number" id="foodQuantity" class="formControl stepperInput" value="100" min="0">
                    <button type="button" id="qtyInc" class="stepperBtn plus">&plus;</button>
                </div>
            </div>

            <button type="submit" class="submitBtn">Add Meal</button>
            <button type="button" id="closeAddMeal" class="closeBtn secondaryBtn">Cancel</button>
        </form>
    </div>
</div>

<div id="statsContainer" class="modalOverlay hiddenView">
    <div class="statsView">
        <header class="statsHeader">
            <h3>Statistics</h3>
            <button id="closeStats" class="iconBtn">&times;</button>
        </header>
        
        <div class="statsTabs">
            <button class="tabBtn active" data-tab="weekly">Weekly</button>
            <button class="tabBtn" data-tab="monthly">Monthly</button>
        </div>

        <div class="statsContent">
            <!-- Charts Section -->
            <div class="chartSection">
                <h4>Nutrient Trends</h4>
                <div class="chartPlaceholder">
                    <!-- Placeholder for Chart.js or similar -->
                    <div class="bar" style="height: 60%"></div>
                    <div class="bar" style="height: 80%"></div>
                    <div class="bar" style="height: 40%"></div>
                    <div class="bar" style="height: 90%"></div>
                    <div class="bar" style="height: 50%"></div>
                    <div class="bar" style="height: 70%"></div>
                    <div class="bar" style="height: 30%"></div>
                </div>
            </div>

            <!-- LLM Insights Section -->
            <div id="llmInsightsContainer" class="insightsSection">
                <div class="insightsHeader">
                    <svg class="insightIcon" width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M9.663 17H14.337C14.677 17 14.945 17.29 14.897 17.625L14.471 20.605C14.422 20.949 14.125 21.2 13.778 21.2H10.222C9.875 21.2 9.578 20.949 9.529 20.605L9.103 17.625C9.055 17.29 9.323 17 9.663 17Z" stroke="#f1c40f" stroke-width="2"/>
                        <path d="M12 17V17C15.866 17 19 13.866 19 10C19 6.13401 15.866 3 12 3C8.13401 3 5 6.13401 5 10C5 13.866 8.13401 17 12 17Z" stroke="#f1c40f" stroke-width="2"/>
                        <path d="M9 10H15" stroke="#f1c40f" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                    <h4>Smart Insights</h4>
                </div>
                <p id="insightText">Analyzing your patterns... Our AI will soon suggest ways to optimize your nutrition based on your weekly trends!</p>
            </div>

            <!-- Averages Table converted to Progress Bars -->
            <div class="avgSection">
                <h4>Average Intake</h4>
                <div class="goalList">
                    <!-- Calories -->
                    <div class="goalItem">
                        <div class="goalHeader">
                            <span class="goalLabel">Calories</span>
                            <span class="goalNumbers"><span class="countUp" data-target="2100">0</span> / 2500</span>
                        </div>
                        <div class="goalTrack">
                            <div class="goalFill" data-width="84%"></div>
                        </div>
                    </div>

                    <!-- Protein -->
                    <div class="goalItem">
                        <div class="goalHeader">
                            <span class="goalLabel">Protein</span>
                            <span class="goalNumbers"><span class="countUp" data-target="140">0</span> / 180g</span>
                        </div>
                        <div class="goalTrack">
                            <div class="goalFill" data-width="77%"></div>
                        </div>
                    </div>

                    <!-- Carbs -->
                    <div class="goalItem">
                        <div class="goalHeader">
                            <span class="goalLabel">Carbs</span>
                            <span class="goalNumbers"><span class="countUp" data-target="250">0</span> / 300g</span>
                        </div>
                        <div class="goalTrack">
                            <div class="goalFill" data-width="83%"></div>
                        </div>
                    </div>

                    <!-- Fat -->
                    <div class="goalItem">
                        <div class="goalHeader">
                            <span class="goalLabel">Fat</span>
                            <span class="goalNumbers"><span class="countUp" data-target="65">0</span> / 80g</span>
                        </div>
                        <div class="goalTrack">
                            <div class="goalFill" data-width="81%"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Side Menu Overlay & Drawer -->
<div id="menuOverlay" class="modalOverlay hiddenView" style="justify-content: flex-end;">
    <div id="sideMenu" class="sideMenu">
        <header class="menuHeader">
            <h3>Menu</h3>
            <button id="closeMenu" class="iconBtn">&times;</button>
        </header>
        <ul class="menuList">
            <li class="menuItem">
                <span class="menuIcon">üë§</span>
                <span>Profile</span>
            </li>
            <li class="menuItem">
                <span class="menuIcon">üéØ</span>
                <span>Goals</span>
            </li>
            <li class="menuItem">
                <span class="menuIcon">‚öôÔ∏è</span>
                <span>Settings</span>
            </li>
        </ul>
    </div>
</div>

<script src="../static/js/script.js"></script>
</body>
</html>